<%- include('partials/inner_header') %>

<div class="container">
    <div class="calculator-container">
        <h1 class="calculator-title"><%= title %></h1>
        
        <div class="unit-switcher">
            <button id="metricBtn" class="unit-btn active">Metric (kg)</button>
            <button id="imperialBtn" class="unit-btn">Imperial (lbs)</button>
        </div>

        <div class="calculator-grid">
            <div class="form-section">
                <form id="waterIntakeForm">
                    <div class="multi-input-group" style="margin-bottom: 1.5rem;">
                        <div class="form-group">
                            <label for="age">Age</label>
                            <div class="input-wrapper"><input type="number" id="age" min="1" max="120" placeholder="e.g., 30"></div>
                        </div>
                        <div class="form-group">
                            <label for="gender">Gender</label>
                            <div class="input-wrapper"><select id="gender"><option value="male">Male</option><option value="female">Female</option></select></div>
                        </div>
                    </div>

                    <!-- Weight Inputs -->
                    <div id="metricInputs" class="form-group">
                        <label for="weightKg">Weight (kg)</label>
                        <div class="input-wrapper"><input type="number" id="weightKg" step="0.1" placeholder="e.g., 70"></div>
                    </div>
                    <div id="imperialInputs" class="form-group" style="display: none;">
                        <label for="weightLbs">Weight (lbs)</label>
                        <div class="input-wrapper"><input type="number" id="weightLbs" step="0.1" placeholder="e.g., 154"></div>
                    </div>

                    <div class="form-group">
                        <label for="activityLevel">Daily Activity Level</label>
                        <div class="input-wrapper">
                            <select id="activityLevel">
                                <option value="sedentary">Sedentary (little or no exercise)</option>
                                <option value="light">Lightly Active (exercise 1-3 days/week)</option>
                                <option value="moderate">Moderately Active (exercise 3-5 days/week)</option>
                                <option value="very">Very Active (hard exercise 6-7 days/week)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="climate">Climate</label>
                        <div class="input-wrapper">
                            <select id="climate">
                                <option value="temperate">Temperate / Cool</option>
                                <option value="warm">Warm</option>
                                <option value="hot">Hot & Humid</option>
                            </select>
                        </div>
                    </div>
                     <div class="form-group">
                         <label>Special Conditions (Optional)</label>
                         <div class="calc-mode-switcher">
                            <button type="button" id="pregnantBtn" class="gender-btn">Pregnant</button>
                            <button type="button" id="breastfeedingBtn" class="gender-btn">Breastfeeding</button>
                         </div>
                     </div>
                </form>
            </div>
            
            <div class="result-section" id="result-section">
                <div class="placeholder">Fill in your details for a personalized hydration plan.</div>
            </div>
        </div>

        <div class="faq-section">
            <div class="accordion-item"><button class="accordion-header"><span>Why is staying hydrated so important?</span><span class="icon">+</span></button><div class="accordion-content"><p>Water is crucial for nearly every bodily function. Proper hydration helps regulate body temperature, deliver nutrients to cells, keep organs functioning properly, prevent infections, and improve sleep quality and mood.</p></div></div>
            <div class="accordion-item"><button class="accordion-header"><span>What are the signs of dehydration?</span><span class="icon">+</span></button><div class="accordion-content"><p>Common signs of mild to moderate dehydration include thirst, dry mouth, infrequent urination, dark-colored urine, fatigue, dizziness, and headache. It's best to drink water consistently throughout the day to avoid these symptoms.</p></div></div>
            <div class="accordion-item"><button class="accordion-header"><span>Do other drinks like coffee and tea count?</span><span class="icon">+</span></button><div class="accordion-content"><p>Yes, they contribute to your daily fluid intake. While caffeinated drinks have a mild diuretic effect, the water in them still results in a net positive fluid gain. However, plain water is the best source of hydration as it's calorie-free and sugar-free.</p></div></div>
	    <div class="accordion-item"><button class="accordion-header"><span>Important Medical Disclaimer</span><span class="icon">+</span></button><div class="accordion-content"><p>This water intake calculator is an informational tool only and should not be a substitute for professional medical advice. For a comprehensive assessment of water intake, please consult a qualified healthcare provider.</p></div>
    </div>
        </div>
    </div>
</div>

<script>
    const allInputs = document.querySelectorAll('input, select');
    const resultDiv = document.getElementById('result-section');
    
    // Unit Switcher
    const metricBtn = document.getElementById('metricBtn');
    const imperialBtn = document.getElementById('imperialBtn');
    const metricInputsDiv = document.getElementById('metricInputs');
    const imperialInputsDiv = document.getElementById('imperialInputs');
    
    // Special conditions buttons
    const pregnantBtn = document.getElementById('pregnantBtn');
    const breastfeedingBtn = document.getElementById('breastfeedingBtn');
    let isPregnant = false;
    let isBreastfeeding = false;
    let currentUnit = 'metric';

    // Event Listeners
    allInputs.forEach(input => input.addEventListener('input', calculateWaterIntake));
    metricBtn.addEventListener('click', () => switchUnit('metric'));
    imperialBtn.addEventListener('click', () => switchUnit('imperial'));
    pregnantBtn.addEventListener('click', toggleCondition.bind(null, 'pregnant'));
    breastfeedingBtn.addEventListener('click', toggleCondition.bind(null, 'breastfeeding'));

    function switchUnit(unit) {
        currentUnit = unit;
        metricBtn.classList.toggle('active', unit === 'metric');
        imperialBtn.classList.toggle('active', unit === 'imperial');
        metricInputsDiv.style.display = unit === 'metric' ? 'block' : 'none';
        imperialInputsDiv.style.display = unit === 'imperial' ? 'block' : 'none';
        calculateWaterIntake();
    }
    
    function toggleCondition(condition) {
        if (condition === 'pregnant') {
            isPregnant = !isPregnant;
            pregnantBtn.classList.toggle('active', isPregnant);
            // Can't be pregnant and breastfeeding for this model's purpose
            if (isPregnant && isBreastfeeding) {
                isBreastfeeding = false;
                breastfeedingBtn.classList.remove('active');
            }
        } else if (condition === 'breastfeeding') {
            isBreastfeeding = !isBreastfeeding;
            breastfeedingBtn.classList.toggle('active', isBreastfeeding);
            if (isBreastfeeding && isPregnant) {
                isPregnant = false;
                pregnantBtn.classList.remove('active');
            }
        }
        calculateWaterIntake();
    }

    function calculateWaterIntake() {
        // Get all values
        const age = parseInt(document.getElementById('age').value);
        const weightKg = (currentUnit === 'metric') 
            ? parseFloat(document.getElementById('weightKg').value)
            : parseFloat(document.getElementById('weightLbs').value) * 0.453592;
        
        const activityLevel = document.getElementById('activityLevel').value;
        const climate = document.getElementById('climate').value;
        
        if (isNaN(age) || isNaN(weightKg) || age <= 0 || weightKg <= 0) {
            resultDiv.innerHTML = `<div class="placeholder">Please enter your age and weight.</div>`;
            return;
        }

        // 1. Base calculation on weight (ml)
        let baseIntake = weightKg * 33;

        // 2. Adjust for activity (ml)
        let activityBonus = 0;
        if (activityLevel === 'light') activityBonus = 350;
        else if (activityLevel === 'moderate') activityBonus = 500;
        else if (activityLevel === 'very') activityBonus = 750;
        
        // 3. Adjust for climate (ml)
        let climateBonus = 0;
        if (climate === 'warm') climateBonus = 250;
        else if (climate === 'hot') climateBonus = 500;
        
        // 4. Adjust for special conditions (ml)
        let conditionBonus = 0;
        if (isPregnant) conditionBonus = 300;
        else if (isBreastfeeding) conditionBonus = 700;

        const totalIntakeMl = baseIntake + activityBonus + climateBonus + conditionBonus;

        const totalLiters = totalIntakeMl / 1000;
        const totalOunces = totalIntakeMl / 29.574;
        const totalGlasses = totalIntakeMl / 240; // Assuming 8 oz / 240 ml glass

        resultDiv.innerHTML = `
            <div class="result-display-new">
                <p class="result-main-text-large">Your Recommended Daily Intake</p>
                <p class="result-main-text" style="font-size: 2.2rem; color: var(--primary-color);"><strong>${totalLiters.toFixed(1)} Liters</strong></p>
                <p class="result-sub-text" style="font-size: 1.2rem;">or ~ ${totalOunces.toFixed(0)} oz / ${totalGlasses.toFixed(0)} glasses (8oz)</p>
            </div>
            <div class="bf-details-container">
                <h4>How we calculated this:</h4>
                <div class="bf-details-item"><span>Base intake (from weight)</span><strong>${(baseIntake/1000).toFixed(1)} L</strong></div>
                ${activityBonus > 0 ? `<div class="bf-details-item"><span>+ For Activity</span><strong>${(activityBonus/1000).toFixed(1)} L</strong></div>` : ''}
                ${climateBonus > 0 ? `<div class="bf-details-item"><span>+ For Climate</span><strong>${(climateBonus/1000).toFixed(1)} L</strong></div>` : ''}
                ${conditionBonus > 0 ? `<div class="bf-details-item"><span>+ For ${isPregnant ? 'Pregnancy' : 'Breastfeeding'}</span><strong>${(conditionBonus/1000).toFixed(1)} L</strong></div>` : ''}
            </div>
        `;
    }
// --- EI CODE-TA ADD KORA HOLO ---
document.querySelectorAll('.accordion-header').forEach(header => {
    header.addEventListener('click', () => {
        const accordionItem = header.parentElement;
        accordionItem.classList.toggle('active');
        const content = header.nextElementSibling;
        content.style.maxHeight = accordionItem.classList.contains('active') ? content.scrollHeight + 'px' : '0px';
    });
});
</script>

<%- include('partials/inner_footer') %>